# 单位系统

## 重要提醒

⚠️ **文档同步说明**：

更新本文档时，必须同步更新以下关联文档：
- **[单位属性配置表.md](单位属性配置表.md)** - 单位的完整属性数值配置
- **[工作流配置系统.md](工作流配置系统.md)** - 单位的工作流配置和匹配度分析

特别是属性配置必须使用**统一的配置结构**和**同一套API**，详见 [单位属性配置表.md](单位属性配置表.md) 的"配置系统设计"部分。

---

## 概述

MazeMaster2D 游戏中包含22种不同类型的单位，根据遇敌行为分为两大类：**功能类**和**战斗类**。

### 核心术语

#### 单位分类术语

- **种族**：单位本身的类型（哥布林/地精/兽人/狼人/巨魔/牛头人/半人马）
  - 示例：哥布林、地精、兽人属于不同种族
  - 特殊：狼人、巨魔、牛头人、半人马属于神秘生物种族（召唤单位）

- **职业**：统一种族的不同工作（斥候/战士/猎手等）
  - 示例：哥布林种族包括哥布林、哥布林斥候、哥布林战士等职业

#### 单位获取方式术语

- **进化**：消耗金币、魔力、时间将一个种族转化为另一个种族
  - 示例：哥布林→地精（地牢之心仅需金币，地精巢穴需金币+魔力）、哥布林→兽人（需金币+魔力）
  - 特点：跨种族转化，多数需要魔力资源和建筑支持，地牢之心进化例外仅需金币

- **训练**：消耗金币、时间将同一种族的单位从一个职业转化为另一个职业
  - 示例：哥布林→哥布林斥候（哨塔）、兽人→兽人战士（训练场）
  - 特点：同种族内转化，仅消耗金币和建筑

- **召唤**：消耗魔力、时间并进行特殊的操作（例如仪式）凭空产生一个单位
  - 示例：萨满在献祭塔举行仪式召唤狼人/巨魔/牛头人/半人马
  - 特点：特殊建筑+特殊单位+仪式操作

- **购买**：消耗自身的金币交互各种资源
  - 示例：兽人猎手购买装备→兽人劲弩猎手、兽人战士购买装备→兽人重装战士
  - 特点：单位自身消耗金币，在特定建筑（武器库）完成

#### 单位类型分类

- **功能类单位**（4种）：哥布林、地精、地精酒保、地精铁匠
  - 主要职责：资源采集、建造修复、服务等
  - 遇敌行为：逃跑（远离敌人，靠近主基地）
  - 特点：非战斗单位，遇敌立即逃跑
  
- **战斗类单位**（18种）：哥布林斥候、哥布林战士、兽人、兽人打手、兽人斥候、兽人猎手、兽人劲弩猎手、兽人战士、兽人重装战士、兽人角斗士、兽人王牌斗士、兽人冠军、兽人驯兽师、兽人萨满、狼人、巨魔、牛头人、半人马
  - 主要职责：巡逻、守护、战斗、专业服务等
  - 遇敌行为：反击（靠近敌人进行攻击）
  - 特点：具有战斗能力，遇敌立即反击

## 单位类型总览

### 哥布林种族

| 序号 | 单位名称   | 类型分类 | 主要功能           | 工作流优先级         | 建筑关联                           | 遇敌行为 | 获取方式   |
| ---- | ---------- | -------- | ------------------ | -------------------- | ---------------------------------- | -------- | ---------- |
| 1    | 哥布林     | 功能类   | 挖掘金矿           | Mining (5)           | 地牢之心、兽人巢穴、哨塔、地精巢穴 | 遇敌逃跑 | 初始单位   |
| 2    | 哥布林斥候 | 战斗类   | 跟随哨塔巡逻[远程] | Combat (10) → Patrol | 哨塔                               | 遇敌反击 | 哨塔训练   |
| 3    | 哥布林战士 | 战斗类   | 守护警戒塔/游荡    | Combat (10) → Guard  | 训练场                             | 遇敌反击 | 训练场训练 |

### 地精种族

| 序号 | 单位名称 | 类型分类 | 主要功能                 | 工作流优先级           | 建筑关联           | 遇敌行为 | 获取方式   |
| ---- | -------- | -------- | ------------------------ | ---------------------- | ------------------ | -------- | ---------- |
| 4    | 地精     | 功能类   | 建造/修复/装填(搬运资源) | Repair (7) → Build (6) | 地牢之心、地精巢穴 | 遇敌逃跑 | 进化       |
| 5    | 地精酒保 | 功能类   | 酒馆服务/存储管理        | Service (4)            | 酒馆               | 遇敌逃跑 | 酒馆训练   |
| 6    | 地精铁匠 | 功能类   | 打造装备/装备存储        | Crafting (4)           | 锻造场             | 遇敌逃跑 | 锻造场训练 |

### 兽人种族

| 序号 | 单位名称     | 类型分类 | 主要功能            | 工作流优先级          | 建筑关联 | 遇敌行为 | 获取方式       |
| ---- | ------------ | -------- | ------------------- | --------------------- | -------- | -------- | -------------- |
| 7    | 兽人         | 战斗类   | 游荡                | Combat (10) → Idle    | 兽人巢穴 | 遇敌反击 | 进化           |
| 8    | 兽人打手     | 战斗类   | 守护酒馆            | Combat (10) → Guard   | 酒馆     | 遇敌反击 | 酒馆训练       |
| 9    | 兽人斥候     | 战斗类   | 哨塔巡逻            | Combat (10) → Patrol  | 哨塔     | 遇敌反击 | 哨塔训练       |
| 10   | 兽人猎手     | 战斗类   | 狩猎/分解猎物[远程] | Combat (10) → Hunting | 狩猎塔   | 遇敌反击 | 狩猎塔训练     |
| 11   | 兽人劲弩猎手 | 战斗类   | 狩猎/分解猎物[远程] | Combat (10) → Hunting | 武器库   | 遇敌反击 | 武器库购买装备 |
| 12   | 兽人战士     | 战斗类   | 守护警戒塔/游荡     | Combat (10) → Guard   | 训练场   | 遇敌反击 | 训练场训练     |
| 13   | 兽人重装战士 | 战斗类   | 守护警戒塔/游荡     | Combat (10) → Guard   | 武器库   | 遇敌反击 | 武器库购买装备 |
| 14   | 兽人角斗士   | 战斗类   | 竞技场战斗/游荡     | Combat (10) → Arena   | 竞技场   | 遇敌反击 | 竞技场训练     |
| 15   | 兽人王牌斗士 | 战斗类   | 竞技场战斗/游荡     | Combat (10) → Arena   | 竞技场   | 遇敌反击 | 竞技场晋级     |
| 16   | 兽人冠军     | 战斗类   | 竞技场战斗/游荡     | Combat (10) → Arena   | 竞技场   | 遇敌反击 | 竞技场晋升     |
| 17   | 兽人驯兽师   | 战斗类   | 捕获野兽/驯服       | Combat (10) → Taming  | 驯兽塔   | 遇敌反击 | 驯兽塔训练     |
| 18   | 兽人萨满     | 战斗类   | 治疗/仪式[魔法]     | Combat (10) → Ritual  | 献祭塔   | 遇敌反击 | 献祭塔训练     |

### 野兽人（召唤单位）

| 序号 | 单位名称 | 类型分类 | 主要功能   | 工作流优先级       | 建筑关联 | 遇敌行为 | 获取方式       |
| ---- | -------- | -------- | ---------- | ------------------ | -------- | -------- | -------------- |
| 19   | 狼人     | 战斗类   | 游荡       | Combat (10) → Idle | 献祭塔   | 遇敌反击 | 献祭塔仪式召唤 |
| 20   | 巨魔     | 战斗类   | 游荡       | Combat (10) → Idle | 献祭塔   | 遇敌反击 | 献祭塔仪式召唤 |
| 21   | 牛头人   | 战斗类   | 游荡       | Combat (10) → Idle | 献祭塔   | 遇敌反击 | 献祭塔仪式召唤 |
| 22   | 半人马   | 战斗类   | 游荡[远程] | Combat (10) → Idle | 献祭塔   | 遇敌反击 | 献祭塔仪式召唤 |

## 单位详细信息

### 哥布林种族

#### 1. 哥布林（Goblin）
- **种族**：哥布林
- **类型**：功能类
- **主要功能**：挖掘金矿
- **建筑关联**：地牢之心、兽人巢穴、哨塔、地精巢穴
- **遇敌行为**：逃跑

#### 2. 哥布林斥候（Goblin Scout）[远程]
- **种族**：哥布林
- **类型**：战斗类
- **主要功能**：跟随当前哨塔的兽人斥候行动
- **建筑关联**：哨塔
- **遇敌行为**：反击

#### 3. 哥布林战士（Goblin Warrior）
- **种族**：哥布林
- **类型**：战斗类
- **主要功能**：守护警戒塔{长时间} / 游荡{短时间}
- **建筑关联**：训练场
- **遇敌行为**：反击

### 地精种族

#### 4. 地精（Goblin Engineer）
- **种族**：地精（由哥布林进化）
- **类型**：功能类
- **主要功能**：修建建筑 / 修复建筑 / 装填建筑（搬运资源）
- **建筑关联**：地牢之心、地精巢穴
- **遇敌行为**：逃跑

#### 5. 地精酒保（Goblin Bartender）
- **种族**：地精
- **类型**：功能类
- **主要功能**：前往食物存储点拿取食物补充酒馆 / 将酒馆的金币存储到最近的金币存储点
- **建筑关联**：酒馆
- **遇敌行为**：逃跑

#### 6. 地精铁匠（Goblin Smith）
- **种族**：地精
- **类型**：功能类
- **主要功能**：前往矿物存储点拿取矿物打造装备 / 将装备存储到最近的武器库
- **建筑关联**：锻造场
- **遇敌行为**：逃跑

### 兽人种族

#### 7. 兽人（Orc）
- **种族**：兽人（由哥布林进化）
- **类型**：战斗类
- **主要功能**：游荡
- **建筑关联**：兽人巢穴
- **遇敌行为**：反击

#### 8. 兽人打手（Orc Bouncer）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：守护当前酒馆
- **建筑关联**：酒馆
- **遇敌行为**：反击

#### 9. 兽人斥候（Orc Scout）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：在当前基地范围内巡逻
- **建筑关联**：哨塔
- **遇敌行为**：反击

#### 10. 兽人猎手（Orc Hunter）[远程]
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：寻找狩猎场进行狩猎 / 将猎物分解为食物
- **建筑关联**：狩猎塔
- **遇敌行为**：反击

#### 11. 兽人劲弩猎手（Orc Crossbow Hunter）[远程]
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：寻找狩猎场进行狩猎 / 将猎物分解为食物
- **建筑关联**：武器库（由兽人猎手购买装备后生成）
- **遇敌行为**：反击

#### 12. 兽人战士（Orc Warrior）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：守护警戒塔{长时间} / 游荡{短时间}
- **建筑关联**：训练场
- **遇敌行为**：反击

#### 13. 兽人重装战士（Orc Heavy Warrior）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：守护警戒塔{长时间} / 游荡{短时间}
- **建筑关联**：武器库（由兽人战士购买装备后生成）
- **遇敌行为**：反击

#### 14. 兽人角斗士（Orc Gladiator）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：在竞技场与敌方俘虏、友方单位、驯服后的野兽进行战斗{短时间}（其中一方生命值低于30%后停止）/ 游荡{长时间}
- **建筑关联**：竞技场
- **遇敌行为**：反击

#### 15. 兽人王牌斗士（Orc Elite Gladiator）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：在竞技场与敌方俘虏、友方单位、驯服后的野兽进行战斗{短时间}（其中一方生命值低于30%后停止）/ 游荡{长时间}
- **建筑关联**：竞技场（兽人角斗士多次胜利后晋级）
- **遇敌行为**：反击

#### 16. 兽人冠军（Orc Champion）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：在竞技场与敌方俘虏、友方单位、驯服后的野兽进行战斗{短时间}（其中一方生命值低于30%后停止）/ 游荡{长时间}
- **建筑关联**：竞技场（兽人王牌斗士多次连胜后晋升）
- **遇敌行为**：反击

#### 17. 兽人驯兽师（Orc Beastmaster）
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：跟随兽人猎手前往狩猎场捕获凶猛的野兽 / 在驯兽塔驯服野兽
- **建筑关联**：驯兽塔
- **遇敌行为**：反击

#### 18. 兽人萨满（Orc Shaman）[魔法]
- **种族**：兽人
- **类型**：战斗类
- **主要功能**：治疗附近的单位 / 在献祭塔举行各种仪式{短时间} / 游荡{长时间}
- **建筑关联**：献祭塔
- **遇敌行为**：反击

### 野兽人（召唤单位）

#### 19. 狼人（Werewolf）
- **种族**：狼人
- **类型**：战斗类
- **主要功能**：游荡
- **建筑关联**：献祭塔
- **遇敌行为**：反击
- **获取方式**：由献祭塔举行的仪式随机生成

#### 20. 巨魔（Troll）
- **种族**：巨魔
- **类型**：战斗类
- **主要功能**：游荡
- **建筑关联**：献祭塔
- **遇敌行为**：反击
- **获取方式**：由献祭塔举行的仪式随机生成

#### 21. 牛头人（Minotaur）
- **种族**：牛头人
- **类型**：战斗类
- **主要功能**：游荡
- **建筑关联**：献祭塔
- **遇敌行为**：反击
- **获取方式**：由献祭塔举行的仪式随机生成

#### 22. 半人马（Centaur）[远程]
- **种族**：半人马
- **类型**：战斗类
- **主要功能**：游荡
- **建筑关联**：献祭塔
- **遇敌行为**：反击
- **获取方式**：由献祭塔举行的仪式随机生成

## 单位进化与训练流程

### 哥布林 → 地精（进化）
- **需求建筑**：地牢之心或地精巢穴
- **消耗资源**：地牢之心需金币；地精巢穴需金币 + 魔力
- **转化时间**：60秒（地牢之心）/ 90秒（地精巢穴）
- **槽位数量**：地牢之心1个，地精巢穴2个

### 哥布林 → 兽人（进化）
- **需求建筑**：兽人巢穴
- **消耗资源**：金币 + 魔力
- **转化时间**：90秒
- **槽位数量**：2个

### 哥布林 → 哥布林斥候（训练）
- **需求建筑**：哨塔
- **消耗资源**：金币
- **转化时间**：60秒
- **槽位数量**：3个

### 哥布林 → 哥布林战士（训练）
- **需求建筑**：训练场
- **消耗资源**：金币
- **转化时间**：75秒
- **槽位数量**：5个

### 地精 → 地精酒保（训练）
- **需求建筑**：酒馆
- **消耗资源**：金币
- **转化时间**：60秒
- **槽位数量**：1个

### 地精 → 地精铁匠（训练）
- **需求建筑**：锻造场
- **消耗资源**：金币
- **转化时间**：90秒
- **槽位数量**：1个

### 兽人 → 兽人打手（训练）
- **需求建筑**：酒馆
- **消耗资源**：金币
- **转化时间**：120秒
- **槽位数量**：3个

### 兽人 → 兽人斥候（训练）
- **需求建筑**：哨塔
- **消耗资源**：金币
- **转化时间**：90秒
- **槽位数量**：1个

### 兽人 → 兽人猎手（训练）
- **需求建筑**：狩猎塔
- **消耗资源**：金币
- **转化时间**：120秒
- **槽位数量**：1个

### 兽人猎手 → 兽人劲弩猎手（购买装备）
- **需求建筑**：武器库
- **消耗资源**：金币（自身消耗）
- **转化时间**：即时
- **槽位数量**：无限制

### 兽人 → 兽人战士（训练）
- **需求建筑**：训练场
- **消耗资源**：金币
- **转化时间**：90秒
- **槽位数量**：2个

### 兽人战士 → 兽人重装战士（购买装备）
- **需求建筑**：武器库
- **消耗资源**：金币（自身消耗）
- **转化时间**：即时
- **槽位数量**：无限制

### 兽人 → 兽人角斗士（训练）
- **需求建筑**：竞技场
- **消耗资源**：金币
- **转化时间**：150秒
- **槽位数量**：5个

### 兽人角斗士 → 兽人王牌斗士（晋级）
- **需求建筑**：竞技场
- **消耗资源**：多次胜利
- **转化时间**：战斗后
- **槽位数量**：无限制

### 兽人王牌斗士 → 兽人冠军（晋升）
- **需求建筑**：竞技场
- **消耗资源**：多次连胜
- **转化时间**：战斗后
- **槽位数量**：无限制

### 兽人 → 兽人驯兽师（训练）
- **需求建筑**：驯兽塔
- **消耗资源**：金币
- **转化时间**：150秒
- **槽位数量**：1个

### 兽人 → 兽人萨满（训练）
- **需求建筑**：献祭塔
- **消耗资源**：金币
- **转化时间**：180秒
- **槽位数量**：1个

### 狼人/巨魔/牛头人/半人马（召唤）
- **需求建筑**：献祭塔
- **消耗资源**：魔力 + 仪式
- **转化时间**：仪式时间
- **获取方式**：由兽人萨满举行仪式随机生成

## 单位属性配置

所有单位的完整属性配置请参见：[单位属性配置表.md](单位属性配置表.md)

该表包含以下核心属性：
- **生命值**：单位最大生命值（10的倍数）
- **攻击力**：单位每次攻击造成的伤害
- **攻击冷却**：两次攻击之间的间隔时间（秒）
- **攻击范围**：单位可以攻击的最大距离（像素）
- **追击范围**：敌人进入此范围后开始追击
  - 远程单位：追击范围 = 攻击范围
  - 近战单位：追击范围 = 攻击范围 × 3
- **护甲值**：减少受到的伤害，公式：实际伤害 = max(1, 攻击力 - 护甲值)
- **体型大小**：用于计算击退距离和碰撞检测

### 属性平衡原则

1. **训练成本 vs 战斗能力**：成本越高，属性越强
2. **DPS平衡**：功能类单位DPS较低，战斗类单位DPS较高
3. **生存能力平衡**：遵循"高攻击力低护甲"原则
4. **特殊单位设计**：召唤单位属性整体高于一般单位

所有战斗类单位均支持遇敌战斗工作流。

**工作流匹配分析**：详细的工作流配置和需求匹配分析请参见：[工作流配置系统.md](工作流配置系统.md)

## 遇敌行为配置

### 功能类单位（4种）
- **哥布林**：遇敌逃跑
- **地精**：遇敌逃跑
- **地精酒保**：遇敌逃跑
- **地精铁匠**：遇敌逃跑

### 战斗类单位（18种）
- **所有其他单位**：遇敌反击

## 特殊标记说明

- **[远程]**：远程攻击单位，使用远程武器进行攻击
- **[魔法]**：魔法单位，拥有特殊能力（如治疗、仪式等）

### 时间比例标记

- **{长时间}**：在该状态停留较长时间，优先保持该状态
- **{短时间}**：在该状态停留较短时间，完成后快速转换

**时间比例配置**：

| 单位类型     | 状态组合                    | 时间比例  |
| ------------ | --------------------------- | --------- |
| 哥布林战士   | 守护警戒塔 {长} / 游荡 {短} | 70% / 30% |
| 兽人战士     | 守护警戒塔 {长} / 游荡 {短} | 70% / 30% |
| 兽人重装战士 | 守护警戒塔 {长} / 游荡 {短} | 70% / 30% |
| 兽人角斗士   | 竞技场战斗 {短} / 游荡 {长} | 20% / 80% |
| 兽人王牌斗士 | 竞技场战斗 {短} / 游荡 {长} | 20% / 80% |
| 兽人冠军     | 竞技场战斗 {短} / 游荡 {长} | 20% / 80% |
| 兽人萨满     | 仪式 {短} / 游荡 {长}       | 30% / 70% |

**说明**：时间比例决定了单位在各工作流状态中的停留时间分配，由工作流系统根据配置自动调整。

---

*最后更新：根据最新需求重构并补充时间比例说明*
